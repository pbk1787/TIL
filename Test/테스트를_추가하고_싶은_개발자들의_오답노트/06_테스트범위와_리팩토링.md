### 테스트 범위

    : 집중해야 하는 테스트 ⇒ 본질

    서비스와 도메인 위 두 부분이 잘 만들어져 있어야 애플리케이션의 내적 품질이 올라가는 것

    (전체 테스트를 위한 최소 조건)

    - 낮은 커버리지가 걱정 ⇒ 도메인이 그만큼 빈약하다는 의미. 서비스 경쟁력 의심

### 의존성 역적 원리를 이용하여 구성

    : 인터페이스를 이용하여 외부를 다룸. 

    - 호출자와 구현제를 독립적으로 구성
    - Fake 객체를 이용하여 일관성있는 데이터를 받을 수 있도록 구현

### Mockito와 H2를 사용하지 않고 구현

    - Fake 객체를 이용하여 테스트하기 때문에 소형 테스트로 구성
    - 같은 기능을 어떻게 테스트 하냐에 따라, 테스트의 크기가 결정된다

### 패키지 리팩토링

    - legacy : Layer로 분류
        - 장점: 구조가 단순하고 처음 접할때 사용하기 편함
        - 단점: 도메인이 눈에 보이지 않음, 동시 작업 떨어짐

    - refactory : domain/layer로 분류
        - 장점: 어떤 도메인을 다루는 시스템인지 보임, MSA로 시스템 확장 가능
        - 단점: MVC에 익숙한 경우 컴포넌트 찾기 어려울 수 있음

        - repository → infrastructure 로 패키지명 수정하여 외부 연동도 함께 들어가도록 패키지 구조 수정

        - 패키지 의존성 확인: 순환 참조가 생기는지 의식하며 개발해야한다 (소프트공학에서 피해야하는 해악)

        - jpa entity와 도메인 모델을 분리

        - setter를 없애고 domain/vo로 로직 이동. 도메인 엔티티 테스트

        - CQRS 적용
            - 명령과 질의의 책임 분리
            - 메소드 명령과 질의로 나누자
                - 명령 메소드: 상태를 바꾸는 메소드
                    - void 타입이여야 한다. 종종 return this하는 경우가 있는데 안됨
                - 질의 메소드: 상태를 물어보는 메소드
                    - 상태를 변경해서는 안된다.
                    
            - return 타입이 void가 아니라면 객체의 상태를 변경해선 안된다
            - repository 대신 reader / writer 로 표현